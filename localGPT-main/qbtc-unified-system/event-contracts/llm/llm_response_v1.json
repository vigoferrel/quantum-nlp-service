{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://qbtc.io/events/llm/response/v1",
  "title": "LLM Response Event",
  "description": "Schema for a response sent from the Quantum Consciousness Core after processing an LLM request.",
  "type": "object",
  "properties": {
    "status": {
      "description": "Indicates the outcome of the processing.",
      "type": "string",
      "enum": ["success", "error"]
    },
    "request_id": {
      "description": "The unique identifier of the original request, for correlation.",
      "type": "string",
      "format": "uuid"
    },
    "response_payload": {
      "description": "The payload of the response, following OpenAI's format.",
      "type": "object",
      "properties": {
        "choices": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "message": {
                "type": "object",
                "properties": {
                  "content": { "type": "string" }
                },
                "required": ["content"]
              }
            },
            "required": ["message"]
          }
        },
        "usage": {
          "type": "object",
          "properties": {
            "prompt_tokens": { "type": "integer" },
            "completion_tokens": { "type": "integer" },
            "total_tokens": { "type": "integer" }
          },
          "required": ["prompt_tokens", "completion_tokens", "total_tokens"]
        }
      },
      "required": ["choices", "usage"]
    },
    "message": {
        "description": "An error message, present only if status is 'error'.",
        "type": "string"
    }
  },
  "required": [
    "status",
    "request_id"
  ]
}
